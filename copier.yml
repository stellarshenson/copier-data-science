# Copier configuration for copier-data-science template

_subdirectory: template

# Process all files as Jinja templates (not just .jinja files)
_templates_suffix: ""

_jinja_extensions:
  - jinja2_time.TimeExtension

# Questions - mirroring ccds.json structure

project_name:
  type: str
  default: "{{ _copier_conf.dst_path.name }}"
  when: false

repo_name:
  type: str
  default: "{{ project_name.lower().replace(' ', '_') }}"
  help: "Repository name (derived from project name)"

env_name:
  type: str
  default: "{{ project_name.lower().replace(' ', '_') }}"
  help: "Environment name (derived from project name)"

module_name:
  type: str
  default: "{{ 'lib_' + repo_name.replace('-', '_') }}"
  help: "Python module name (lib_ prefix for installable packages)"

author_name:
  type: str
  default: ""
  help: "Author name (e.g., John Doe, Acme Corp)"
  placeholder: "Your name or organization"

description:
  type: str
  default: ""
  help: "Brief project description (e.g., ML pipeline for customer churn prediction)"
  placeholder: "A short description of the project"

python_version_number:
  type: str
  default: "3.12"
  help: "Python version"

# Dataset storage - simplified from nested dict
dataset_storage:
  type: str
  choices:
    - none
    - s3
    - azure
    - gcs
  default: none
  help: "Cloud storage provider for datasets"

s3_bucket:
  type: str
  default: ""
  when: "{{ dataset_storage == 's3' }}"
  help: "S3 bucket name (e.g., my-project-data)"
  placeholder: "my-bucket-name"

s3_aws_profile:
  type: str
  default: "default"
  when: "{{ dataset_storage == 's3' }}"
  help: "AWS profile for S3 access (from ~/.aws/credentials)"

azure_container:
  type: str
  default: ""
  when: "{{ dataset_storage == 'azure' }}"
  help: "Azure container name (e.g., my-project-data)"
  placeholder: "my-container-name"

gcs_bucket:
  type: str
  default: ""
  when: "{{ dataset_storage == 'gcs' }}"
  help: "GCS bucket name (e.g., my-project-data)"
  placeholder: "my-bucket-name"

environment_manager:
  type: str
  choices:
    - uv
    - conda
    - virtualenv
    - none
  default: uv
  help: "Python environment manager"

env_location:
  type: str
  choices:
    - local
    - global
  default: local
  when: "{{ environment_manager == 'conda' }}"
  help: "Conda environment location (local .venv or global)"

dependency_file:
  type: str
  choices: "{{ ['pyproject.toml', 'requirements.txt', 'environment.yml'] if environment_manager == 'conda' else ['pyproject.toml', 'requirements.txt'] }}"
  default: pyproject.toml
  help: "Primary dependency file format"

pydata_packages:
  type: str
  choices:
    - none
    - basic
  default: none
  help: "Include basic PyData packages (numpy, pandas, scikit-learn, matplotlib)"

testing_framework:
  type: str
  choices:
    - pytest
    - unittest
    - none
  default: pytest
  help: "Testing framework"

linting_and_formatting:
  type: str
  choices:
    - ruff
    - flake8+black+isort
  default: ruff
  help: "Linting and formatting tools"

open_source_license:
  type: str
  choices:
    - MIT
    - BSD-3-Clause
    - No license file
  default: MIT
  help: "Open source license"

docs:
  type: str
  choices:
    - mkdocs
    - none
  default: mkdocs
  help: "Documentation framework"

include_code_scaffold:
  type: str
  choices:
    - "Yes"
    - "No"
  default: "Yes"
  help: "Include example code scaffold"

jupyter_kernel_support:
  type: str
  choices:
    - "Yes"
    - "No"
  default: "Yes"
  help: "Register Jupyter kernel during environment creation"

env_encryption:
  type: str
  choices:
    - "Yes"
    - "No"
  default: "Yes"
  help: "Enable .env file encryption with OpenSSL AES-256"

docker_support:
  type: str
  choices:
    - "No"
    - "Yes"
  default: "No"
  help: "Include Docker support with Dockerfile and Makefile targets"

docker_package_manager:
  type: str
  choices:
    - "uv"
    - "pip"
  default: "uv"
  help: "Package manager for Docker image"
  when: "{{ docker_support == 'Yes' }}"

custom_config:
  type: str
  default: ""
  help: "Path to custom config overlay (optional)"

# Computed cookiecutter namespace for template compatibility
# This creates a dict that allows {{ cookiecutter.var }} syntax in templates
cookiecutter:
  type: json
  default: "{}"
  when: false

_exclude:
  - copier.yml
  - "*.pyc"
  - __pycache__
  - .git

# Post-generation tasks
# Pass all variables as command-line arguments since extra_env isn't supported
_tasks:
  - >-
    python3 "{{ _copier_conf.src_path }}/scripts/post_gen.py"
    --project-name "{{ project_name }}"
    --repo-name "{{ repo_name }}"
    --env-name "{{ env_name }}"
    --module-name "{{ module_name }}"
    --author-name "{{ author_name }}"
    --description "{{ description }}"
    --python-version "{{ python_version_number }}"
    --dataset-storage "{{ dataset_storage }}"
    --s3-bucket "{{ s3_bucket | default('') }}"
    --s3-aws-profile "{{ s3_aws_profile | default('default') }}"
    --azure-container "{{ azure_container | default('') }}"
    --gcs-bucket "{{ gcs_bucket | default('') }}"
    --environment-manager "{{ environment_manager }}"
    --env-location "{{ env_location | default('local') }}"
    --dependency-file "{{ dependency_file }}"
    --pydata-packages "{{ pydata_packages }}"
    --testing-framework "{{ testing_framework }}"
    --linting-and-formatting "{{ linting_and_formatting }}"
    --open-source-license "{{ open_source_license }}"
    --docs "{{ docs }}"
    --include-code-scaffold "{{ include_code_scaffold }}"
    --jupyter-kernel-support "{{ jupyter_kernel_support }}"
    --env-encryption "{{ env_encryption }}"
    --docker-support "{{ docker_support }}"
    --docker-package-manager "{{ docker_package_manager | default('uv') }}"
    --custom-config "{{ custom_config }}"

# Answers file for template updates
_answers_file: .copier-answers.yml
